(()=>{"use strict";const e={generateCompletion:async(e,t="gemma3:4b")=>{var o;const n=await fetch("http://localhost:11434/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:t,prompt:e})});if(!n.ok){await n.text();throw new Error(`Ollama API error: ${n.status} ${n.statusText}`)}const r=null===(o=n.body)||void 0===o?void 0:o.getReader();if(!r)throw new Error("Failed to get reader from response body.");const a=new TextDecoder;let s="",i=null;for(;;){const{done:e,value:t}=await r.read();if(e)break;s+=a.decode(t,{stream:!0});const o=s.split("\n");s=o.pop()||"";for(const e of o)if(""!==e.trim())try{i=JSON.parse(e)}catch(e){}}return i},testConnection:async()=>{try{return 200===(await fetch("http://localhost:11434/api/version",{method:"GET"})).status}catch(e){return!1}}};const t=new class{async generateResponse(t,o={}){const{model:n="llama3",temperature:r=.7}=o;try{return await e.generateCompletion(t,n)}catch(e){throw e}}async testConnection(){return await e.testConnection()}};chrome.runtime.onInstalled.addListener((()=>{chrome.storage.sync.set({lmStudioApiUrl:"http://localhost:6223",lmStudioModelName:"google/gemma-3-4b"})})),(async()=>{if(await t.testConnection())try{await t.generateResponse("Hello, Ollama!")}catch(e){}})(),chrome.action.onClicked.addListener((e=>{chrome.sidePanel.setOptions({path:"popup.html"},(()=>{void 0!==e.id&&void 0!==e.windowId&&chrome.sidePanel.open({tabId:e.id,windowId:e.windowId})}))})),chrome.runtime.onMessage.addListener(((e,t,o)=>{if("extractPageContent"===e.action||"extractVideoInfo"===e.action)return chrome.tabs.query({active:!0,currentWindow:!0},(t=>{const n=t[0];if(!(null==n?void 0:n.id))return void o({error:"No active tab found"});const r=n.id;chrome.tabs.sendMessage(r,e,(t=>{chrome.runtime.lastError?chrome.scripting.executeScript({target:{tabId:r},files:["contentScript.js"]},(()=>{chrome.tabs.sendMessage(r,e,(e=>{o(e)}))})):o(t)}))})),!0}))})();
//# sourceMappingURL=background.js.map