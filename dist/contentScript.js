(()=>{"use strict";chrome.runtime.onMessage.addListener(((t,e,o)=>{if(console.log("Content script received message:",t),"extractPageContent"===t.action)try{const t=function(){var t,e;try{const o=document.title,n=(null===(t=document.querySelector('meta[name="description"]'))||void 0===t?void 0:t.getAttribute("content"))||(null===(e=document.querySelector('meta[property="og:description"]'))||void 0===e?void 0:e.getAttribute("content"))||"";let r="";const i=["main","article",'[role="main"]',"#content",".content","body"];for(const t of i){const e=document.querySelector(t);if(null==e?void 0:e.textContent){r=e.textContent;break}}const c=Array.from(document.querySelectorAll("h1, h2, h3")).map((t=>{var e;return{level:t.tagName.toLowerCase(),text:(null===(e=t.textContent)||void 0===e?void 0:e.trim())||""}})),l=document.querySelector("main")||document.querySelector("article"),a=Array.from(l?l.querySelectorAll("a"):document.querySelectorAll("a")).map((t=>{var e;return{text:(null===(e=t.textContent)||void 0===e?void 0:e.trim())||"",href:t.href,isImportant:!t.closest("nav")&&!t.closest("footer")}})).filter((t=>t.isImportant)).slice(0,100),d=Array.from(document.querySelectorAll("img")).map((t=>({alt:t.alt,src:t.src,width:t.width,height:t.height}))).filter((t=>t.width>100&&t.height>100)).slice(0,20),u={url:window.location.href,title:o,metaDescription:n,mainContent:r.substring(0,1e7),headings:c,links:a,images:d};return console.log("Extracted content:",u),u}catch(t){throw console.error("Error in extractPageContent:",t),t}}();console.log("Extracted page content:",t),o({content:t})}catch(t){console.error("Error extracting page content:",t),o({error:"Failed to extract page content"})}else if("extractPdfContent"===t.action)o({status:"PDF extraction not supported in content script"});else if("extractVideoInfo"===t.action)try{const t=function(){var t,e,o,n,r;if(window.location.hostname.includes("youtube.com")){const i=(null===(t=document.querySelector("h1.title"))||void 0===t?void 0:t.textContent)||(null===(e=document.querySelector("h1"))||void 0===e?void 0:e.textContent)||"Unknown Video Title",c=(null===(o=document.querySelector("div#description"))||void 0===o?void 0:o.textContent)||"No description available",l=(null===(n=document.querySelector('[class*="owner-name"]'))||void 0===n?void 0:n.textContent)||"Unknown Channel",a=(null===(r=document.querySelector(".ytp-time-duration"))||void 0===r?void 0:r.textContent)||"Unknown Duration";return{platform:"YouTube",title:i.trim(),channel:l.trim(),description:c.trim().substring(0,1e3),duration:a,url:window.location.href}}const i=document.querySelectorAll("video");return i.length>0?{platform:"Generic",title:document.title,videoCount:i.length,url:window.location.href}:{platform:"Unknown",title:document.title,message:"No video detected on this page",url:window.location.href}}();console.log("Extracted video info:",t),o({info:t})}catch(t){console.error("Error extracting video info:",t),o({error:"Failed to extract video information"})}return!0}))})();